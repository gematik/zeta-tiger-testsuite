[#A_27802]
==== A_27802 - ZETA Guard, JWT Prüfung

Der ZETA Guard MUSS bei der Prüfung von JWT folgende Prüfschritte durchführen:
JWT Header-Überprüfung: Zuerst überprüfen, ob der Algorithmus akzeptabel ist, um unnötige Verarbeitung zu vermeiden.
Gültige Algorithmen sind in
[gemSpec_Krypt] festgelegt.
Payload-Überprüfung:

* Ablaufdatum (exp): prüfen, um abgelaufene Tokens sofort abzulehnen.
* Audience (aud): prüfen, ob das Token für den beabsichtigten Empfänger bestimmt ist.
* Issuer (iss): Sicherstellen, dass der Aussteller dem erwarteten Aussteller entspricht.
Integrität der Nachricht: Hash-Überprüfung: Sicherstellen, dass die Nachricht nicht manipuliert wurde.
Schlüsselvalidierung: Überprüfen, ob der öffentliche Schlüssel gültig und vertrauenswürdig ist.
Vertrauenswürdigkeit der Schlüsselkette: Bestätigen, dass der Schlüssel von einer vertrauenswürdigen Quelle stammt.
Spezifische Prüfungen für TI-Zertifikate:

* Ablaufdatum des Zertifikats: Sicherstellen, dass das Zertifikat noch gültig ist.
* Widerrufsstatus des Zertifikats (OCSP): Prüfen, ob das Zertifikat nicht widerrufen wurde.
Die OCSP Response wird für eine konfigurierbare Dauer zwischengespeichert, um zu häufige OCSP Anfragen zu verhindern.
Die Dauer soll der Gültigkeitsdauer des Refresh Token entsprechen.
* Vertrauenswürdigkeit der Zertifikatskette: Sicherstellen, dass die Kette zu einer vertrauenswürdigen Root-CA führt.
Spezifische Prüfungen für DPoP Token:

* Typ: Prüfen, dass der JWT-Typ dpop+jwt ist.
* Nonce: Die Nonce muss geprüft werden.
